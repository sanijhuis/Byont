datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}
model User {
  id                Int      @id @default(autoincrement())
  username          String   @unique
  githubAccessToken String   @unique
  email             String   @unique
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  repos             Repo[]
}

model Repo {
  id          Int          @id @default(autoincrement())
  userId      Int
  user        User         @relation(fields: [userId], references: [id])
  name        String
  owner       String
  scanOutputs ScanOutput[]

  @@unique([name, owner], name: "name_owner")
}

model ScanOutput {
  id                Int              @id @default(autoincrement())
  repoId            Int
  repo              Repo             @relation(fields: [repoId], references: [id])
  date              DateTime
  scanOutputItems   ScanOutputItem[] 
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
}

model ScanOutputItem {
  id           Int        @id @default(autoincrement())
  scanOutputId Int
  scanOutput   ScanOutput @relation(fields: [scanOutputId], references: [id])
  filename     String
  slither      Json?
  mythril      Json?
  chatgpt      String?
}

enum Scanner {
  SLITHER
  MYTHRIL
}